\documentclass[a4paper]{article}
%\usepackage{siunitx}
\input{/home/maso/uni/bachelor-2/preamble.tex}
\input{./preamble-master.tex}
\geometry{right=2cm,left=2cm}

\begin{document}
\begin{titlepage}
\center
    
% HEADING SECTIONS
\textsc{\LARGE Corso di Laboratorio II}\\[1.5cm] % Name of your university/college
%\textsc{\Large Scuola di Scienze}\\[0.5cm] % Major heading such as course name
\textsc{\large Turno 2A}\\[0.5cm] % Minor heading such as course title
\textsc{\large Gruppo 14}\\[0.5cm]

% TITLE SECTION
\HRule \\[0.6cm]
{ \huge \bfseries Circuiti 3: sulle funzioni di trasferimento}\\[0.4cm] % Title of your document
\HRule \\[1.5cm]
    

% If you don't want a supervisor, uncomment the two lines below and remove the section above
\Large \emph{Autori:} \\
\textsc{} \\
\textsc{} \\
\textsc{} \\ [4cm]

\vspace{8cm}

% DATE SECTION
{\large Anno Accademico 2021-2022}\\[2cm] % Anno Accademico

% LOGO SECTION
%\includegraphics[width=0.30\textwidth]{logo.png}\\[1cm] % Include a department/university logo

\vfill
\end{titlepage}

% Pagina bianca
%\newpage\null\thispagestyle{blank}\newpage

% Sommario
\pagenumbering{roman}

%\begin{abstract}
%    \addcontentsline{toc}{section}{\numberline{}Sommario}
%    \noindent Si studia la curva risonanza di un oscillatore armonico semplice, smorzato, e forzato.
%\end{abstract}

% Indice
\tableofcontents
\clearpage

% Elenco delle figure
\listoffigures
\addcontentsline{toc}{section}{\numberline{}Elenco delle figure}
\clearpage

% Corpo del testo
\pagenumbering{arabic}
\setcounter{page}{1}

%\title{}
%\maketitle
%\tableofcontents
%\clearpage
\section{Parte prima: funzioni di trasferimento nei circuiti RL ed RC}
\subsection{Obiettivi}
Si studiano le funzioni di trasferimento all'interno di circuiti RL e RC in tensione alternata. Successivamente, si determinano i valori delle osservabili caratterizzanti il condensatore e l'induttore.

\subsection{Metodo}
Dopo aver impostato il circuito come in figura, si calcola la tensione del generatore reale $V_g$ su tutto il circuito e la tensione $V_R$ sulla resistenza.
\begin{figure}[htpb]
\begin{center}
\begin{circuitikz}
	\draw
	(0,0) to[sV=$V_g^\text{ideale}$] (0,1.5)
	to[R=$R_g$, resistors/scale=0.8] (0,3)
	to[C=$C$] (4,3)
	to[R=$R$] (4,0)
	-- (0,0)
	;
	\draw
	(0.5,0) node[ground]{}
	;
	\draw
	(1,3) to[oscope, *-*] (1,0)
	(3,3) to [oscope, *-*] (3,0)
	;
\end{circuitikz}\hspace{20mm}
\begin{circuitikz}
	\draw
	(0,0) to[sV=$V_g^\text{ideale}$] (0,1.5)
	to[R=$R_g$, resistors/scale=0.8] (0,3)
	to[L=$L$] (4,3)
	to[R=$R$] (4,0)
	-- (0,0)
	(1,3) to[oscope, *-*] (1,0)
	(3,3) to [oscope, *-*] (3,0)
	;
	\draw
	(0.5,0) node[ground]{}
	;
\end{circuitikz}
\end{center}
	\caption[Schemi circuiti RC ed RL]{Schemi dei circuiti RC ed RL con rappresentata la posizione delle sonde dell'oscilloscopio.}
	\label{fig:RL_RC}
\end{figure}
Grazie alle impostazioni dell'oscilloscopio (Tektronix TDS 1001C-EDU) è possibile ricavare direttamente la loro differenza $V_{C,L}(t) = V_g(t) - V_R(t)$ che è esattamente la tensione che si ha sul condensatore (induttore) del circuito.\\
Successivamente si ricava anche la differenza di fase $\Delta\phi'(\omega)$ tra $V_{C,L}$ e $V_g$, e la differenza di fase $\Delta\phi''(\omega)$ tra $V_g$ e $V_R$. Questi dati sono stati ottenuti dall'oscilloscopio in dotazione tramite specifiche funzioni con cui si può calcolare direttamente le differenze di fase sopra descritte.\\
Il calcolo manuale di $\Delta\phi'$ e $\Delta\phi''$ avrebbe previsto la valutazione della differenza temporale tra gli zeri delle due onde e la moltiplicazione di essa per la frequenza del generatore. Risulta preferibile utilizzare gli zeri rispetto ai picchi in quanto l'incertezza sulla tensione è minore a causa della pendenza della forma del segnale.\\
Si utilizza un condensatore con capacità $C=\SI{1}{\micro\F}$ ed una resistenza $R=\SI{2.002(11)}{\kohm}$. Ogni misura riportata --- tranne per il valore della resistenza --- è ottenuta facendo misure ripetute da cui si estrae la media e la deviazione della media.

Di seguito le formule utilizzate per le funzioni di trasferimento. Per $H_1(\omega):\;V_g\to V_{C,L}$ si ha:
\[
	\abs{H_1(\omega)}=\abs{\frac{V_{C,L}}{V_g}},\quad \arg{[H_1(\omega)]}=\Delta\phi'(\omega)
\] 
Per $H_2(\omega):\;V_g\to V_R$ si ha:
\[
	\abs{H_2(\omega)}=\abs{\frac{V_R}{V_g}},\quad \arg{[H_2(\omega)]}=\Delta \phi''(\omega)
\] 
Come si può osservare, le funzioni di trasferimento sono particolari ad ogni componente.

\clearpage
\subsection{Dati ed analisi}
I dati rilevanti raccolti sono:
\begin{center}
\begin{tabular}[t]{c|c}
        \multicolumn{2}{c}{RC} \\
	$f$/\SI{}{\Hz} & $\abs{H_C(\omega)}$ \\\midrule
	\SI{10}{} & \SI{1.004(9)}{} \\
	\SI{20}{} & \SI{0.986(5)}{} \\
	\SI{30}{} & \SI{0.953(4)}{} \\
	\SI{50}{} & \SI{0.887(4)}{} \\
	\SI{70}{} & \SI{0.797(4)}{} \\
	\SI{100}{} & \SI{0.673(4)}{} \\
	\SI{200}{} & \SI{0.426(5)}{} \\
	\SI{300}{} & \SI{0.2929(9)}{} \\
	\SI{400}{} & \SI{0.2259(7)}{} \\
	\SI{500}{} & \SI{0.1844(12)}{} \\
	\SI{600}{} & \SI{0.1541(4)}{} \\
	\SI{700}{} & \SI{0.1342(4)}{} \\
\end{tabular}\qquad
\begin{tabular}[t]{c|c}
	\multicolumn{2}{c}{RL}\\
	$f$/\SI{}{\kHz} & $\abs{H_L(\omega)}$ \\\midrule
	\SI{4}{} & \SI{0.453(6)}{} \\
	\SI{5}{} & \SI{0.533(4)}{} \\
	\SI{6}{} & \SI{0.606(3)}{} \\
	\SI{8}{} & \SI{0.724(4)}{} \\
	\SI{20}{} & \SI{0.937(5)}{} \\
	\SI{30}{} & \SI{0.976(4)}{} \\
	\SI{40}{} & \SI{0.993(2)}{} \\
	\SI{50}{} & \SI{1.005(6)}{} \\
	\SI{60}{} & \SI{1.005(6)}{} \\
	\SI{70}{} & \SI{1.005(3)}{} \\
\end{tabular}
\end{center}

Le funzioni di trasferimento utilizzate il circuito RC ed il circuito RL rispettivamente sono:
\begin{gather*}
	\abs{H_C(\omega)}=\abs{\frac{V_C}{V_g}}=\frac{1}{\sqrt{1+(\omega RC)^2} },\quad \Delta \phi'(\omega)=-\arctan(\omega RC)\\
	\abs{H_L(\omega)}=\abs{\frac{V_L}{V_g}}=\frac{\omega L}{\sqrt{R^2+(\omega L)^2} },\quad \Delta \phi'(\omega)=\frac{\pi}{2}-\arctan \frac{\omega L}{R}
\end{gather*}
In particolare, l'espressione per il modulo è utilizzata per le interpolazioni:
\[
	\abs{H_C(\omega)}=\frac{1}{\sqrt{1+(\omega RC)^2} }+A,\qquad \abs{H_L(\omega)}=\frac{\omega L}{\sqrt{R^2+(\omega L)^2} }+B
\] 
dove $R=\SI{2.002(11)}{\kohm}$ è noto. Si ricavano i parametri:
\begin{center}
\begin{tabular}[t]{c|c|c}
        %\multicolumn{3}{c}{Sovra-smorzato} \\
	Parametro & Valore & Unità \\\midrule
	$C$ & $\SI{0.864(5)}{}$ & $\SI{}{\micro\F}$\\
	$L$ & $\SI{40.3(3)}{}$ & $\SI{}{\milli\henry}$\\
	$A$ & $\SI{6.6(9)e-3}{}$ & \\
	$B$ & $\SI{12.3(17)e-3}{}$ & \\
\end{tabular}
\end{center}
$H_C$: $\chi^2=12$, DoF $=10$, $p$-value $=28\%$. $H_L$: $\chi^2=7$, DoF $=8$, $p$-value $=53\%$.

\subsection{Conclusioni}
Il valore misurato di capacità è prossimo alla quantità riportata sul componente stesso. Il valore di induttanza misurato non è in accordo con quanto trovato precedentemente di $L=\SI{85(3)}{\milli\henry}$.\\

La forma d'onda data dal generatore non varia rispetto alla tensione $V_g$ del circuito in quanto la tensione picco-picco è sempre costante e non ci sono elementi circuitali che potrebbero creare un calo di tensione. Sperimentalmente, si ha soltanto qualche piccola variazione a causa della resistenza interna del generatore di funzioni.\\
L'induttanza ha una propria resistenza interna in quanto non è ideale. Essa può essere considerata come una induttanza ideale posta in serie ad una resistenza. Indubbiamente, tale resistenza dev'essere considerata nei calcoli del circuito, a meno che sia di un ordine di grandezza trascurabile.\\
Le funzioni di trasferimento sono caratterizzate in modo differente a seconda delle tensioni che si vanno a considerare. Come si può notare dalle equazioni sopra scritte, le tensioni variano a seconda della posizione relativa delle sonde e delle componenti. Dunque, si possono avere differenti funzioni di trasferimento per uno stesso circuito.\\
In un circuito RC ad alte frequenze, il condensatore induce una grande alterazione all'onda in quanto il tempo di caricamento totale è maggiore rispetto al periodo dell'onda della tensione generata. Infatti, a frequenze più basse non ci sono alterazioni ampiamente apprezzabili. Avviene esattamente il contrario con un circuito RL in quanto la tensione sull'induttanza diminuisce all'aumentare del tempo.

\begin{figure}[ht]
	\centering
    	\hspace*{-0.75cm}
    	\begin{tikzpicture}
    	\begin{groupplot}[group style={group size=2 by 2, group name=RC, vertical sep=2cm}]
    	\nextgroupplot[
        	%title={RC},
        	width=0.45\textwidth,
        	height=0.4\textwidth,
        	xlabel={$f$/\SI{}{\Hz}},
        	ylabel={$\abs{H_C(\omega)}$},
        	%ylabel style={rotate=-90},
        	xmin=5, xmax=1600,
        	ymin=0.1, ymax=1.2,
		%every x tick scale label/.style={at={(rel axis cs:1,0)},anchor=south west,inner sep=1pt},
        	%xtick={0.1,10,100},
        	%minor x tick num=10,
		%minor xtick={1,2,...,9,20,30,...,90},
        	%ytick={0,0.5,...,2},
        	minor y tick num=1,
		xmode=log,
		ymode=log,
		log ticks with fixed point,
        	ymajorgrids=true,
		yminorgrids=true,
        	xmajorgrids=true,
        	grid style=dashed,
        	legend pos=north east,
        	]
        	
        	\addplot+[
        	color=red,
        	only marks,
        	mark=x,
        	mark size=3pt,
        	%smooth,
        	error bars/.cd,
        	x fixed = 1E-6,
        	y fixed,
        	x dir=both,
        	y dir=both,y explicit,
        	]
		table [x=Hz 1, y=y 1, y error=yerr 1, col sep=comma] {../Dati.csv};
		%restrict y to domain*=0.01:2, 
        	%\addplot[red, samples=200, thick, domain=1:1700, opacity=0.5] plot (\x, {1/sqrt(1+2002*2002*8.34e-7*8.34e-7*x*x)});
        	%plot (\x, { 1/sqrt(1+(x*2002*0.000000863688949577858)*(x*2002*0.000000863688949577858))+0.00663916038624595});
        	\legend{Data, Fit}
    	\nextgroupplot[
        	%title={Fase},
        	width=0.45\textwidth,
        	height=0.4\textwidth,
		xshift=1cm,
        	xlabel={$f$/\SI{}{\Hz}},
		ylabel={$\arg{[H_C(\omega)]}$},
        	%ylabel style={rotate=-90},
        	xmin=-50, xmax=800,
        	ymin=-1.5, ymax=0,
		%every x tick scale label/.style={at={(rel axis cs:1,0)},anchor=south west,inner sep=1pt},
        	%xtick={0.1,10,100},
        	minor x tick num=1,
		%minor xtick={1,2,...,9,20,30,...,90},
        	%ytick={1},
		%minor ytick={.1,.2,...,.9},
        	minor y tick num=4,
        	ymajorgrids=true,
        	xmajorgrids=true,
        	grid style=dashed,
        	legend pos=north east,
        	]
        	
        	\addplot+[
        	color=red,
        	only marks,
        	mark=x,
        	mark size=3pt,
        	error bars/.cd,
        	x fixed = 1E-6,
        	y fixed,
        	x dir=both,
        	y dir=both,y explicit,
        	]
		table [x=Hz 9, y=y 9, y error=yerr 9, col sep=comma] {../Dati.csv};
        	%\addplot[red, samples=200, thick, domain=-50:800, restrict y to domain*=-2:0, opacity=0.5]
        	%plot (\x, { -atan(deg((\x)*2*3.141592653*2002*8.34e-7))});
        	%\legend{Data, Fit}
    	\nextgroupplot[
        	%title={RC},
        	width=0.45\textwidth,
        	height=0.4\textwidth,
        	xlabel={$f$/\SI{}{\Hz}},
        	ylabel={$\abs{H_R(\omega)}$},
        	%ylabel style={rotate=-90},
        	xmin=5, xmax=1600,
        	ymin=0.08, ymax=1.2,
		%every x tick scale label/.style={at={(rel axis cs:1,0)},anchor=south west,inner sep=1pt},
        	%xtick={0.1,10,100},
        	%minor x tick num=10,
		%minor xtick={1,2,...,9,20,30,...,90},
        	%ytick={0,0.5,...,2},
        	minor y tick num=1,
		xmode=log,
		ymode=log,
		log ticks with fixed point,
        	ymajorgrids=true,
		yminorgrids=true,
        	xmajorgrids=true,
        	grid style=dashed,
        	legend pos=north east,
        	]
        	
        	\addplot+[
        	color=red,
        	only marks,
        	mark=x,
        	mark size=3pt,
        	%smooth,
        	error bars/.cd,
        	x fixed = 1E-6,
        	y fixed,
        	x dir=both,
        	y dir=both,y explicit,
        	]
		table [x=Hz 13, y=y 13, y error=yerr 13, col sep=comma] {../Dati.csv};
        	%\addplot[red, samples=200, thick, domain=-1:1, restrict y to domain*=-1:21, opacity=0.5]
        	%plot (\x, { 9.87851856244373*(1.0-exp(-x/0.110970220619361)*2/(1+exp(-1/(2*0.8*0.110970220619361))))+ 9.80405290231027 });
        	%\legend{Data, Fit}
    	\nextgroupplot[
        	%title={Fase},
        	width=0.45\textwidth,
        	height=0.4\textwidth,
        	xlabel={$f$/\SI{}{\Hz}},
		ylabel={$\arg{[H_R(\omega)]}$},
        	%ylabel style={rotate=-90},
        	xmin=-50, xmax=800,
        	ymin=0, ymax=1.6,
		%every x tick scale label/.style={at={(rel axis cs:1,0)},anchor=south west,inner sep=1pt},
        	%xtick={0.1,10,100},
        	minor x tick num=1,
		%minor xtick={1,2,...,9,20,30,...,90},
        	%ytick={1},
		%minor ytick={.1,.2,...,.9},
        	minor y tick num=4,
        	ymajorgrids=true,
        	xmajorgrids=true,
        	grid style=dashed,
        	legend pos=north east,
        	]
        	
        	\addplot+[
        	color=red,
        	only marks,
        	mark=x,
        	mark size=3pt,
        	error bars/.cd,
        	x fixed = 1E-6,
        	y fixed,
        	x dir=both,
        	y dir=both,y explicit,
        	]
		table [x=Hz 11, y=y 11, y error=yerr 11, col sep=comma] {../Dati.csv};
        	%\addplot[red, samples=200, thick, domain=-1:1, restrict y to domain*=-1:3, opacity=0.5]
        	%plot (\x, { 1.03215733712524*(2*exp(-x/0.0770411899367807)/(1+exp(-10/(2*0.0770411899367807)))+59.5173303163154/(59.5173303163154+50+992)*(1-2*exp(-x/0.0770411899367807)/(1+exp(-10/(2*0.0770411899367807)))))+0.0547706142068078 });
        	%\legend{Data, Fit}
    	\end{groupplot}
	\path (RC c1r1.north east) --node[above=0.335cm]{RC} (RC c2r1.north west);
    	\end{tikzpicture}
	\caption[Grafici RC]{Grafici della funzione di trasferimento rispetto al tempo dei dati raccolti per un condensatore e per un resistore. $H_C$: $\chi^2=12$, DoF $=10$, $p$-value $=28\%$.}
	\label{fig:RC}
\end{figure}
\begin{figure}[ht]
	\centering
    	\hspace*{-0.75cm}
    	\begin{tikzpicture}
    	\begin{groupplot}[group style={group size=2 by 2, group name=RL, vertical sep=2cm}]
    	\nextgroupplot[
        	%title={RL},
        	width=0.45\textwidth,
        	height=0.4\textwidth,
        	xlabel={$f$/\SI{}{\kHz}},
        	ylabel={$\abs{H_L(\omega)}$},
        	%ylabel style={rotate=-90},
        	xmin=3, xmax=100,
        	ymin=0.2, ymax=1.2,
		%every x tick scale label/.style={at={(rel axis cs:1,0)},anchor=south west,inner sep=1pt},
        	%xtick={0.1,10,100},
        	%minor x tick num=10,
		%minor xtick={1,2,...,9,20,30,...,90},
        	ytick={1},
        	%minor y tick num=1,
		minor ytick={.1,.2,...,.9},
		xmode=log,
		ymode=log,
		log ticks with fixed point,
        	ymajorgrids=true,
		yminorgrids=true,
        	xmajorgrids=true,
        	grid style=dashed,
        	legend pos=south east,
        	]
        	
        	\addplot+[
        	color=red,
        	only marks,
        	mark=x,
        	mark size=3pt,
        	error bars/.cd,
        	x fixed = 1E-6,
        	y fixed,
        	x dir=both,
        	y dir=both,y explicit,
        	]
		table [x=kHz 2, y=y 2, y error=yerr 2, col sep=comma] {../Dati.csv};
        	%\addplot[red, samples=200, thick, domain=-1:1, restrict y to domain*=-1:3, opacity=0.5]
        	%plot (\x, { 1.03215733712524*(2*exp(-x/0.0770411899367807)/(1+exp(-10/(2*0.0770411899367807)))+59.5173303163154/(59.5173303163154+50+992)*(1-2*exp(-x/0.0770411899367807)/(1+exp(-10/(2*0.0770411899367807)))))+0.0547706142068078 });
        	\legend{Data, Fit}
    	\nextgroupplot[
        	%title={RL},
        	width=0.45\textwidth,
        	height=0.4\textwidth,
		xshift=1cm,
        	xlabel={$f$/\SI{}{\kHz}},
		ylabel={$\arg{[H_L(\omega)]}$},
        	%ylabel style={rotate=-90},
        	xmin=-5, xmax=80,
        	ymin=0, ymax=1.3,
		%every x tick scale label/.style={at={(rel axis cs:1,0)},anchor=south west,inner sep=1pt},
        	%xtick={0.1,10,100},
        	minor x tick num=1,
		%minor xtick={1,2,...,9,20,30,...,90},
        	%ytick={1},
        	minor y tick num=1,
		%minor ytick={.1,.2,...,.9},
        	ymajorgrids=true,
        	xmajorgrids=true,
        	grid style=dashed,
        	legend pos=south east,
        	]
        	
        	\addplot+[
        	color=red,
        	only marks,
        	mark=x,
        	mark size=3pt,
        	error bars/.cd,
        	x fixed = 1E-6,
        	y fixed,
        	x dir=both,
        	y dir=both,y explicit,
        	]
		table [x=kHz 10, y=y 10, y error=yerr 10, col sep=comma] {../Dati.csv};
        	%\addplot[red, samples=200, thick, domain=-1:1, restrict y to domain*=-1:3, opacity=0.5]
        	%plot (\x, { 1.03215733712524*(2*exp(-x/0.0770411899367807)/(1+exp(-10/(2*0.0770411899367807)))+59.5173303163154/(59.5173303163154+50+992)*(1-2*exp(-x/0.0770411899367807)/(1+exp(-10/(2*0.0770411899367807)))))+0.0547706142068078 });
        	%\legend{Data, Fit}
    	\nextgroupplot[
        	%title={RL},
        	width=0.45\textwidth,
        	height=0.4\textwidth,
        	xlabel={$f$/\SI{}{\kHz}},
        	ylabel={$\abs{H_R(\omega)}$},
        	%ylabel style={rotate=-90},
        	xmin=3, xmax=100,
        	ymin=0.1, ymax=1.2,
		%every x tick scale label/.style={at={(rel axis cs:1,0)},anchor=south west,inner sep=1pt},
        	%xtick={0.1,10,100},
        	%minor x tick num=10,
		%minor xtick={1,2,...,9,20,30,...,90},
        	%ytick={1},
        	%minor y tick num=1,
		%minor ytick={.1,.2,...,.9},
		xmode=log,
		ymode=log,
		log ticks with fixed point,
        	ymajorgrids=true,
		yminorgrids=true,
        	xmajorgrids=true,
        	grid style=dashed,
        	legend pos=south east,
        	]
        	
        	\addplot+[
        	color=red,
        	only marks,
        	mark=x,
        	mark size=3pt,
        	error bars/.cd,
        	x fixed = 1E-6,
        	y fixed,
        	x dir=both,
        	y dir=both,y explicit,
        	]
		table [x=kHz 14, y=y 14, y error=yerr 14, col sep=comma] {../Dati.csv};
        	%\addplot[red, samples=200, thick, domain=-1:1, restrict y to domain*=-1:3, opacity=0.5]
        	%plot (\x, { 1.03215733712524*(2*exp(-x/0.0770411899367807)/(1+exp(-10/(2*0.0770411899367807)))+59.5173303163154/(59.5173303163154+50+992)*(1-2*exp(-x/0.0770411899367807)/(1+exp(-10/(2*0.0770411899367807)))))+0.0547706142068078 });
        	%\legend{Data, Fit}
    	\nextgroupplot[
        	%title={RL},
        	width=0.45\textwidth,
        	height=0.4\textwidth,
        	xlabel={$f$/\SI{}{\kHz}},
		ylabel={$\arg{[H_R(\omega)]}$},
        	%ylabel style={rotate=-90},
        	xmin=-5, xmax=80,
        	ymin=-1.8, ymax=-0.2,
		%every x tick scale label/.style={at={(rel axis cs:1,0)},anchor=south west,inner sep=1pt},
        	%xtick={0.1,10,100},
        	minor x tick num=1,
		%minor xtick={1,2,...,9,20,30,...,90},
        	%ytick={1},
        	minor y tick num=1,
		%minor ytick={.1,.2,...,.9},
        	ymajorgrids=true,
        	xmajorgrids=true,
        	grid style=dashed,
        	legend pos=south east,
        	]
        	
        	\addplot+[
        	color=red,
        	only marks,
        	mark=x,
        	mark size=3pt,
        	error bars/.cd,
        	x fixed = 1E-6,
        	y fixed,
        	x dir=both,
        	y dir=both,y explicit,
        	]
		table [x=kHz 12, y=y 12, y error=yerr 12, col sep=comma] {../Dati.csv};
        	%\addplot[red, samples=200, thick, domain=-1:1, restrict y to domain*=-1:3, opacity=0.5]
        	%plot (\x, { 1.03215733712524*(2*exp(-x/0.0770411899367807)/(1+exp(-10/(2*0.0770411899367807)))+59.5173303163154/(59.5173303163154+50+992)*(1-2*exp(-x/0.0770411899367807)/(1+exp(-10/(2*0.0770411899367807)))))+0.0547706142068078 });
        	%\legend{Data, Fit}
    	\end{groupplot}
	\path (RL c1r1.north east) --node[above=0.335cm]{RL} (RL c2r1.north west);
    	\end{tikzpicture}
	\caption[Grafici RL]{Grafici della funzione di trasferimento rispetto alla frequenza dei dati raccolti per un induttore e per un resistore. $H_L$: $\chi^2=7$, DoF $=8$, $p$-value $=53\%$.}
	\label{fig:RC_RL}
\end{figure}
\clearpage
\section{Parte seconda: funzioni di trasferimento nei circuiti RLC}
\subsection{Obiettivi}
Si studiano le funzioni di trasferimento per un circuito RLC in corrente alternata.

\subsection{Metodo}
Si dispone il circuito come in figura e, generando una tensione alternata, si ricava la tensione $V_g$ su tutto il circuito e si ricava la tensione $V_R$ sulla resistenza.
\begin{figure}[htpb]
\begin{center}
\begin{circuitikz}
	\draw
	(0,0) to[sV=$V_g^\text{ideale}$] (0,1.5)
	to[R=$R_g$, resistors/scale=0.8] (0,3)
	-- (1,3)
	to[L=$L$] (3,3)
	to[C=$C$] (5,3) -- (6,3)
	to[R=$R$] (6,0)
	-- (0,0)
	;
	\draw
	(0.5,0) node[ground]{}
	;
	\draw
	(1,3) to[oscope, *-*] (1,0)
	(5,3) to [oscope, *-*] (5,0)
	;
\end{circuitikz}
\end{center}
	\caption[Schema circuito RLC]{Schema del circuito RLC con rappresentata la posizione delle sonde dell'oscilloscopio.}
	\label{fig:RLC_circuit}
\end{figure}
Si studiano le funzioni di trasferimento da $V_g$ alle tensioni sulle componenti: $V_R$, $V_C$ e $V_L$. Per misurare la tensione su ciascuna componente, si pone questa alla fine del circuito: in questo modo la sonda di destra dell'oscilloscopio non cambia mai posizione né riferimento.

\subsection{Dati ed analisi}
I dati raccolti per il modulo delle funzioni di trasferimento sono:
\begin{center}
\begin{tabular}[t]{c|c}
        \multicolumn{2}{c}{R} \\
	$f$/\SI{}{\Hz} & $\abs{H_R(\omega)}$ \\\midrule
	\SI{20}{} & \SI{0.2147(7)}{} \\
	\SI{40}{} & \SI{0.4013(14)}{} \\
	\SI{50}{} & \SI{0.4784(16)}{} \\
	\SI{60}{} & \SI{0.546(3)}{} \\
	\SI{80}{} & \SI{0.655(3)}{} \\
	\SI{100}{} & \SI{0.730(4)}{} \\
	\SI{200}{} & \SI{0.9094(3)}{} \\
	\SI{400}{} & \SI{0.953(9)}{} \\
	\SI{500}{} & \SI{0.973(4)}{} \\
\end{tabular}\qquad
\begin{tabular}[t]{c|c}
	\multicolumn{2}{c}{C}\\
	$f$/\SI{}{\Hz} & $\abs{H_C(\omega)}$ \\\midrule
	\SI{10}{} & \SI{0.98785(5)}{} \\
	\SI{25}{} & \SI{0.959(4)}{} \\
	\SI{30}{} & \SI{0.943(4)}{} \\
	\SI{50}{} & \SI{0.868(6)}{} \\
	\SI{100}{} & \SI{0.670(3)}{} \\
	\SI{150}{} & \SI{0.513(4)}{} \\
	\SI{300}{} & \SI{0.2800(9)}{} \\
\end{tabular}\qquad
\begin{tabular}[t]{c|c}
	\multicolumn{2}{c}{L}\\
	$f$/\SI{}{\kHz} & $\abs{H_L(\omega)}$ \\\midrule
	\SI{1}{} & \SI{0.1183(5)}{} \\
	\SI{4}{} & \SI{0.4277(13)}{} \\
	\SI{5}{} & \SI{0.507(3)}{} \\
	\SI{6}{} & \SI{0.583(2)}{} \\
	\SI{20}{} & \SI{0.931(4)}{} \\
	\SI{30}{} & \SI{0.970(4)}{} \\
	\SI{40}{} & \SI{0.983(4)}{} \\
	\SI{50}{} & \SI{0.990(4)}{} \\
\end{tabular}
\end{center}
I dati raccolti per la fase delle funzioni di trasferimento sono:
\begin{center}
\begin{tabular}[t]{c|c}
        \multicolumn{2}{c}{R} \\
	$f$/\SI{}{\Hz} & $\arg{[H_R(\omega)]}$ \\\midrule
	\SI{20}{} & \SI{1.3317(10)}{} \\
	\SI{40}{} & \SI{1.147(6)}{} \\
	\SI{60}{} & \SI{1.002(5)}{} \\
	\SI{80}{} & \SI{0.846(11)}{} \\
	\SI{100}{} & \SI{0.729(13)}{} \\
	\SI{200}{} & \SI{0.3880(6)}{} \\
\end{tabular}\qquad
\begin{tabular}[t]{c|c}
	\multicolumn{2}{c}{C}\\
	$f$/\SI{}{\Hz} & $\arg{[H_C(\omega)]}$ \\\midrule
	\SI{10}{} & \SI{-0.117(4)}{} \\
	\SI{30}{} & \SI{-0.317(8)}{} \\
	\SI{50}{} & \SI{-0.521(4)}{} \\
	\SI{100}{} & \SI{-0.859(7)}{} \\
	\SI{200}{} & \SI{-1.162(5)}{} \\
	\SI{300}{} & \SI{-1.303(5)}{} \\
	\SI{500}{} & \SI{-1.438(5)}{} \\
\end{tabular}\qquad
\begin{tabular}[t]{c|c}
	\multicolumn{2}{c}{L}\\
	$f$/\SI{}{\kHz} & $\arg{[H_L(\omega)]}$ \\\midrule
	\SI{1}{} & \SI{1.402(6)}{} \\
	\SI{2}{} & \SI{1.299(8)}{} \\
	\SI{5}{} & \SI{1.007(8)}{} \\
	\SI{8}{} & \SI{0.786(12)}{} \\
	\SI{20}{} & \SI{0.367(10)}{} \\
	\SI{30}{} & \SI{0.201(3)}{} \\
	\SI{40}{} & \SI{0.141(5)}{} \\
	\SI{50}{} & \SI{0.075(6)}{} \\
\end{tabular}
\end{center}

Le funzioni di trasferimento per le componenti sono:
\begin{gather*}
	\abs{H_R(\omega)}=\abs{\frac{V_R}{V_g}}=\frac{R}{\sqrt{R^2+\left( \omega L-\frac{1}{\omega C} \right)^2} },\quad \Delta \phi'(\omega)=-\arctan \frac{\omega L-\frac{1}{\omega C}}{R}\\
	\abs{H_C(\omega)}=\abs{\frac{V_C}{V_g}}=\frac{\frac{1}{\omega C}}{\sqrt{R^2+\left( \omega L-\frac{1}{\omega C} \right)^2} },\quad \Delta \phi'(\omega)=-\frac{\pi}{2}-\arctan \frac{\omega L-\frac{1}{\omega C}}{R}\\
	\abs{H_L(\omega)}=\abs{\frac{V_L}{V_g}}=\frac{\omega L}{\sqrt{R^2+\left( \omega L-\frac{1}{\omega C} \right)^2} },\quad \Delta \phi'(\omega)=\frac{\pi}{2}-\arctan \frac{\omega L-\frac{1}{\omega C}}{R}
\end{gather*}
Come precedentemente, l'espressione per il modulo viene utilizzata per le interpolazioni. In particolare:
\begin{gather*}
	\abs{H_R(\omega)}=\frac{R}{\sqrt{(R+R_L)^2+\left( \omega L-\frac{1}{\omega C} \right)^2} }+A\\
	\abs{H_C(\omega)}=\frac{\frac{1}{\omega C}}{\sqrt{(R+R_L)^2+\left( \omega L-\frac{1}{\omega C} \right)^2} }+B\\
	\abs{H_L(\omega)}=\frac{\omega L}{\sqrt{R^2+\left( \omega L-\frac{1}{\omega C} \right)^2} }+D
\end{gather*}
dove $R=\SI{2.002(11)}{\kohm}$, mentre $R_L$ è la resistenza intrinseca dell'induttore. I parametri ottenuti sono:
\begin{center}
\begin{tabular}[t]{c|c|c}
        \multicolumn{3}{c}{Resistore} \\
	Parametro & Valore & Unità \\\midrule
	$C$ & $\SI{0.835(6)}{}$ & $\SI{}{\micro\F}$\\
	$L$ & $\SI{120(20)}{}$ & $\SI{}{\milli\henry}$\\
	$R_L$ & $\SI{1.068(10)}{}$ & $\SI{}{\ohm}$\\
	$A$ & $\SI{4.6(19)e-3}{}$ & \\
\end{tabular}\quad
\begin{tabular}[t]{c|c|c}
        \multicolumn{3}{c}{Condensatore} \\
	Parametro & Valore & Unità \\\midrule
	$C$ & $\SI{0.90(2)}{}$ & $\SI{}{\micro\F}$\\
	$L$ & $\SI{230(40)}{}$ & $\SI{}{\milli\henry}$\\
	$R_L$ & $\SI{50(50)}{}$ & $\SI{}{\ohm}$\\
	$B$ & $\SI{-6.27(11)e-3}{}$ & \\
\end{tabular}\\[5mm]
\begin{tabular}[t]{c|c|c}
        \multicolumn{3}{c}{Induttore} \\
	Parametro & Valore & Unità \\\midrule
	$C$ & $\SI{0.27(6)}{}$ & $\SI{}{\micro\F}$\\
	$L$ & $\SI{35.8(5)}{}$ & $\SI{}{\milli\henry}$\\
	$D$ & $\SI{8(2)e-3}{}$ & \\
\end{tabular}
\end{center}
$H_R$: $\chi^2=8.4$, DoF $=5$, $p$-value $=14\%$. $H_C$: $\chi^2=0.64$, DoF $=3$, $p$-value $=89\%$. $H_L$: $\chi^2=5$, DoF $=5$, $p$-value $=41\%$.\\
Successivamente si interpolano anche le fasi secondo:
\begin{gather*}
	\Delta \phi_R'(\omega)=-\arctan \frac{\omega L -\frac{1}{\omega C}}{R}+a\\
	\Delta \phi_C'(\omega)=-\frac{\pi}{2}-\arctan \frac{\omega L -\frac{1}{\omega C}}{R}+b\\
	\Delta \phi_L'(\omega)=\frac{\pi}{2}-\arctan \frac{\omega L -\frac{1}{\omega C}}{R}+d
\end{gather*}
Da cui i parametri sono:
\begin{center}
\begin{tabular}[t]{c|c|c}
        \multicolumn{3}{c}{Resistore} \\
	Parametro & Valore & Unità \\\midrule
	$C$ & $\SI{0.768(13)}{}$ & $\SI{}{\micro\F}$\\
	$L$ & $\SI{82(8)}{}$ & $\SI{}{\milli\henry}$\\
	$a$ & $\SI{-48(4)e-3}{}$ & \\
\end{tabular}\quad
\begin{tabular}[t]{c|c|c}
        \multicolumn{3}{c}{Condensatore} \\
	Parametro & Valore & Unità \\\midrule
	$C$ & $\SI{0.897(13)}{}$ & $\SI{}{\micro\F}$\\
	$L$ & $\SI{23(4)}{}$ & $\SI{}{\milli\henry}$\\
	$b$ & $\SI{-3(5)e-3}{}$ & \\
\end{tabular}\quad
\begin{tabular}[t]{c|c|c}
        \multicolumn{3}{c}{Induttore} \\
	Parametro & Valore & Unità \\\midrule
	$C$ & $\SI{1.5(2)}{}$ & $\SI{}{\micro\F}$\\
	$L$ & $\SI{31.1(9)}{}$ & $\SI{}{\milli\henry}$\\
	$d$ & $\SI{-0.122(9)}{}$ & \\
\end{tabular}
\end{center}
$\phi_R$: $\chi^2=5.65$, DoF $=3$, $p$-value $=13\%$. $\phi_C$: $\chi^2=8$, DoF $=4$, $p$-value $=8.8\%$. $\phi_L$: $\chi^2=16$, DoF $=5$, $p$-value $=0.6\%$.\\
\begin{figure}[ht]
	\centering
    	\hspace*{-0.75cm}
    	\begin{tikzpicture}
    	\begin{groupplot}[group style={group size=2 by 1}]
    	\nextgroupplot[
        	title={Resistore},
        	width=0.45\textwidth,
        	height=0.4\textwidth,
        	xlabel={$f$/\SI{}{\Hz}},
        	ylabel={$\abs{H_R(\omega)}$},
        	%ylabel style={rotate=-90},
        	xmin=-30, xmax=570,
        	ymin=0.1, ymax=1.1,
        	%xtick={0,0.1,...,0.5},
        	minor x tick num=1,
        	%ytick={0,3,...,21},
        	minor y tick num=1,
        	legend pos=south east,
        	ymajorgrids=true,
        	grid style=dashed,
        	]
        	
        	\addplot+[
        	color=red,
        	only marks,
        	mark=x,
        	mark size=3pt,
        	%smooth,
        	error bars/.cd,
        	x fixed = 1E-6,
        	y fixed,
        	x dir=both,
        	y dir=both,y explicit,
        	]
		table [x=Hz 3, y=y 3, y error=yerr 3, col sep=comma] {../Dati.csv};
        	%\addplot[red, samples=200, thick, domain=-1:1, restrict y to domain*=-1:21, opacity=0.5]
        	%plot (\x, { 9.87851856244373*(1.0-exp(-x/0.110970220619361)*2/(1+exp(-1/(2*0.8*0.110970220619361))))+ 9.80405290231027 });
        	\legend{Data, Fit}
    	\nextgroupplot[
        	title={Condensatore},
        	width=0.45\textwidth,
        	height=0.4\textwidth,
		xshift=1cm,
        	xlabel={$f$/\SI{}{\Hz}},
        	ylabel={$\abs{H_C(\omega)}$},
        	%ylabel style={rotate=-90},
        	xmin=-30, xmax=350,
        	ymin=0.2, ymax=1.1,
        	%xtick={0,0.1,...,0.5},
        	minor x tick num=1,
        	%ytick={0,0.5,...,2},
        	minor y tick num=1,
        	legend pos=north east,
        	ymajorgrids=true,
        	grid style=dashed,
        	]
        	
        	\addplot+[
        	color=red,
        	only marks,
        	mark=x,
        	mark size=3pt,
        	error bars/.cd,
        	x fixed = 1E-6,
        	y fixed,
        	x dir=both,
        	y dir=both,y explicit,
        	]
		table [x=Hz 4, y=y 4, y error=yerr 4, col sep=comma] {../Dati.csv};
        	%\addplot[red, samples=200, thick, domain=-1:1, restrict y to domain*=-1:3, opacity=0.5]
        	%plot (\x, { 1.03215733712524*(2*exp(-x/0.0770411899367807)/(1+exp(-10/(2*0.0770411899367807)))+59.5173303163154/(59.5173303163154+50+992)*(1-2*exp(-x/0.0770411899367807)/(1+exp(-10/(2*0.0770411899367807)))))+0.0547706142068078 });
        	%\legend{Data, Fit}
    	\end{groupplot}
    	\end{tikzpicture}
	%\caption[Grafici RC ed RL]{Grafici della funzione di trasferimento rispetto al tempo dei dati raccolti per un condensatore e per un induttore. RC: $\chi^2=$, DoF $=$, $p$-value $=\%$. RL: $\chi^2=$, DoF $=$, $p$-value $=\%$.}
	\label{fig:RLC_graph_R_C}
\end{figure}
\vspace*{-0.75cm}
\begin{figure}[ht]
	\centering
    	\hspace*{-0.75cm}
    	\begin{tikzpicture}
    	\begin{groupplot}[group style={group size=1 by 1}]
    	\nextgroupplot[
        	title={Induttore},
        	width=0.8\textwidth,
        	height=0.4\textwidth,
        	xlabel={$f$/\SI{}{\kHz}},
        	ylabel={$\abs{H_L(\omega)}$},
        	%ylabel style={rotate=-90},
        	xmin=-5, xmax=60,
        	ymin=0, ymax=1.1,
        	%xtick={0,0.1,...,0.5},
        	minor x tick num=1,
        	%ytick={0,0.5,...,2},
        	minor y tick num=1,
        	legend pos=north east,
        	ymajorgrids=true,
        	grid style=dashed,
        	]
        	
        	\addplot+[
        	color=red,
        	only marks,
        	mark=x,
        	mark size=3pt,
        	error bars/.cd,
        	x fixed = 1E-6,
        	y fixed,
        	x dir=both,
        	y dir=both,y explicit,
        	]
		table [x=kHz 5, y=y 5, y error=yerr 5, col sep=comma] {../Dati.csv};
        	%\addplot[red, samples=200, thick, domain=-1:1, restrict y to domain*=-1:3, opacity=0.5]
        	%plot (\x, { 1.03215733712524*(2*exp(-x/0.0770411899367807)/(1+exp(-10/(2*0.0770411899367807)))+59.5173303163154/(59.5173303163154+50+992)*(1-2*exp(-x/0.0770411899367807)/(1+exp(-10/(2*0.0770411899367807)))))+0.0547706142068078 });
        	%\legend{Data, Fit}
    	\end{groupplot}
    	\end{tikzpicture}
	\caption[Grafici RLC]{Grafici del modulo della funzione di trasferimento rispetto alla frequenza dei dati raccolti per un resistore, per un condensatore e per un induttore. $H_R$: $\chi^2=8.4$, DoF $=5$, $p$-value $=14\%$. $H_C$: $\chi^2=0.64$, DoF $=3$, $p$-value $=89\%$. $H_L$: $\chi^2=5$, DoF $=5$, $p$-value $=41\%$.}
	\label{fig:RLC_graph_L}
\end{figure}

\subsection{Conclusioni}
Sebbene quasi ogni interpolazione sia accettabile, molti risultati sono in disaccordo tra loro, sia per il condensatore che per l'induttore. Da due sole interpolazioni si ottiene un valore di induttanza in accordo con quanto misurato in precedenza di $L=\SI{85(3)}{\milli\henry}$.\\
I valori di capacità trovati, nonostante non in accordo tra loro, sono comunque vicini a quanto riportato sull'involucro esterno del condensatore utilizzato.\\

La funzione di trasferimento misurata su $R$ ha la forma di risonanza di una campana e la sua larghezza dipende dall'osservabile $\gamma = \frac{R}{2L}$. Tuttavia, nello studio qualitativo dell'intervallo di frequenze per la funzione di trasferimento del resistore, si è erroneamente valutato tale intervallo, misurando solamente prima della frequenza di risonanza: non è stato possibile osservare la forma a campana.

\end{document}
